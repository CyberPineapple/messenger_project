(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,function(e,t,a){e.exports={block:"MainMenu_block__1f8As",menu:"MainMenu_menu__38NUy",blockView:"MainMenu_blockView___VwR6 MainMenu_block__1f8As",blockHide:"MainMenu_blockHide__2Nz3H MainMenu_block__1f8As",button:"MainMenu_button__28ShO",burger:"MainMenu_burger__3AHHl",line:"MainMenu_line__Wu2K7",line1:"MainMenu_line1__2XgfF MainMenu_line__Wu2K7",line2:"MainMenu_line2__2yxYa MainMenu_line__Wu2K7",line3:"MainMenu_line3__3VQ2r MainMenu_line__Wu2K7",line1Active:"MainMenu_line1Active__KDTAw MainMenu_line__Wu2K7",line2Active:"MainMenu_line2Active__2mMf9 MainMenu_line__Wu2K7",line3Active:"MainMenu_line3Active__3jIUK MainMenu_line__Wu2K7",menu_image:"MainMenu_menu_image__3kold",menu_login:"MainMenu_menu_login__J-DOZ",menu_chat:"MainMenu_menu_chat__RXXU8",menu_chat_list:"MainMenu_menu_chat_list__1Smpe",input:"MainMenu_input__213Gt"}},,,,,,,,function(e,t,a){e.exports={block:"ChatOutput_block__j4dR-",chatName:"ChatOutput_chatName__i2kbH",messagesList:"ChatOutput_messagesList__150gA",deleteButton:"ChatOutput_deleteButton__R0ug5",loading:"ChatOutput_loading__1nGqC",line1:"ChatOutput_line1__2lFyg",spin:"ChatOutput_spin__290Ac",line2:"ChatOutput_line2__SAmw4",line3:"ChatOutput_line3__Jk2Gn"}},,function(e,t,a){e.exports={page:"AuthentificationPage_page__2HM45",layout:"AuthentificationPage_layout__1btWJ",button:"AuthentificationPage_button__1nnUE",input:"AuthentificationPage_input__2s8ii",title:"AuthentificationPage_title__3nREf"}},,function(e,t,a){e.exports={block:"ChatInput_block__WqMEx",inputText:"ChatInput_inputText__2txI7",button:"ChatInput_button__GMiqD",inputFile:"ChatInput_inputFile__3Bk-2",imagesBlock:"ChatInput_imagesBlock__1yzcB",image:"ChatInput_image__qCi_N"}},function(e,t,a){e.exports={message:"Message_message__bb_2g",newMessage:"Message_newMessage__1y6Pg",message_user:"Message_message_user__3Bm2H",message_text:"Message_message_text__1I51v",message_time:"Message_message_time__1clwo",message_image:"Message_message_image__3oYNS"}},function(e,t,a){e.exports={block:"LoadingPage_block__1IOaF",text:"LoadingPage_text__3JhiI",line1:"LoadingPage_line1__2Y0t1",spin:"LoadingPage_spin__2HKox",line2:"LoadingPage_line2__11m1-",line3:"LoadingPage_line3__2g_cJ"}},,,,,,,function(e,t,a){e.exports={menu_chat_list_item:"ChatItem_menu_chat_list_item__1gxCS"}},function(e,t,a){e.exports={clockBLock:"Clock_clockBLock__2HsNj",clock:"Clock_clock__1ljTg"}},,,,,function(e,t,a){e.exports=a.p+"static/media/new_message.8b29b843.mp3"},function(e,t,a){e.exports={layout:"MainPage_layout__1NnJr"}},function(e,t,a){e.exports={block:"ChatContainer_block__3qjWr"}},,function(e,t,a){e.exports=a(43)},,,,,function(e,t,a){},,,,,,function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(18),c=a.n(i),r=(a(37),a(3)),o=a(4),l=a(6),u=a(5),m=a(7),p=a(11),_=a.n(p),h=a(8),d=a(10),g=function(e){return{type:"SET_PAGE",payload:e}},f=function(e){return{type:"SET_LOGIN",payload:e}},E=function(e){return{type:"SET_PASSWORD",payload:e}},v=function(){return{type:"REMOVE_LOGIN"}},C=function(){return{type:"REMOVE_PASSWORD"}},b=function(e){return{type:"SET_MESSAGES_LIST",payload:e}},O=function(){return{type:"REMOVE_MESSAGES_LIST"}},y=function(e){return{type:"ADD_CHAT_NAME",payload:e}},N=function(){return{type:"REMOVE_CHAT_NAME"}},M=function(e){return{type:"ADD_CHAT_PASSWORD",payload:e}},S=function(){return{type:"REMOVE_CHAT_PASSWORD"}},j=function(e){return{type:"ACTIVE_CHAT",payload:e}},w=function(e){return{type:"RENDER_CHAT_OUTPUT",payload:e}},k=a(16),A=a(2),T={page:"loading",login:"",password:"",authentification:!1,connect:!1,message:"",messagesList:[],chatList:[],chatName:"",chatPassword:"",activeChat:"",renderChatOutput:!0,image:""};var P=Object(d.b)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PAGE":return Object(A.a)({},e,{page:t.payload});case"SET_LOGIN":return Object(A.a)({},e,{login:t.payload});case"SET_PASSWORD":return Object(A.a)({},e,{password:t.payload});case"REMOVE_LOGIN":return Object(A.a)({},e,{login:""});case"REMOVE_PASSWORD":return Object(A.a)({},e,{password:""});case"AUTHENTIFICATION":return Object(A.a)({},e,{authentification:t.payload});case"CONNECT":return Object(A.a)({},e,{connect:t.payload});case"SET_MESSAGE":return Object(A.a)({},e,{message:t.payload});case"SET_MESSAGES_LIST":return Object(A.a)({},e,{messagesList:e.messagesList.concat(t.payload)});case"REMOVE_MESSAGE":return Object(A.a)({},e,{message:""});case"SET_CHAT_LIST":return Object(A.a)({},e,{chatList:t.payload});case"ADD_CHAT_NAME":return Object(A.a)({},e,{chatName:t.payload});case"REMOVE_CHAT_NAME":return Object(A.a)({},e,{chatName:""});case"ADD_CHAT_PASSWORD":return Object(A.a)({},e,{chatPassword:t.payload});case"REMOVE_CHAT_PASSWORD":return Object(A.a)({},e,{chatPassword:""});case"ACTIVE_CHAT":return Object(A.a)({},e,{activeChat:t.payload});case"REMOVE_MESSAGES_LIST":return Object(A.a)({},e,{messagesList:[]});case"RENDER_CHAT_OUTPUT":return Object(A.a)({},e,{renderChatOutput:t.payload});case"EARLIER_MESSAGES":return Object(A.a)({},e,{messagesList:[].concat(Object(k.a)(t.payload),Object(k.a)(e.messagesList))});case"SET_IMAGE":return Object(A.a)({},e,{image:t.payload});default:return e}},T),L=a(28),x=a.n(L),I=new WebSocket("wss://host-94-103-84-32.hosted-by-vdsina.ru:443/");I.onopen=function(){P.dispatch(g("authentification")),P.dispatch({type:"CONNECT",payload:!0})},I.onclose=function(){console.log("disconnect"),P.dispatch(g("loading"))},I.onmessage=function(e){var t=JSON.parse(e.data);if(console.log(t),null!==t)switch(t.Type){case"login":if("success"===t.Status){P.dispatch(g("main"));var a={Type:"chat",Command:"choice",Chat:"general"};a=JSON.stringify(a),R(a),a={Type:"chat",Command:"connected"},a=JSON.stringify(a),R(a),P.dispatch(w(!1))}else"error"===t.Status&&console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438");break;case"registration":console.log("\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f");break;case"chat":if("list"===t.Command&&P.dispatch({type:"SET_CHAT_LIST",payload:t.Chats}),"choice"===t.Command&&(P.dispatch(j(t.Chat)),P.dispatch(b(t.Messages)),P.dispatch(w(!0))),"message"===t.Command){if(t.Message.user!==P.getState().login){var n=new Audio;n.src=x.a,n.play()}P.dispatch(b(t.Message))}"earlier"===t.Command&&0!==t.Messages.length&&P.dispatch(function(e){return{type:"EARLIER_MESSAGES",payload:e}}(t.Messages));break;default:console.log(t)}},I.onerror=function(e){console.log("error: ",e)};var R=function(e){I.send(e)},H=R,D=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).goToPage=function(){if(""!==a.props.login&&""!==a.props.password){var e={Type:"login",Login:a.props.login,Password:a.props.password};e=JSON.stringify(e),H(e)}},a.registration=function(){if(""!==a.props.login&&""!==a.props.password){var e={Type:"registration",Login:a.props.login,Password:a.props.password};e=JSON.stringify(e),H(e)}},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:_.a.page},s.a.createElement("div",{className:_.a.layout},s.a.createElement("p",{className:_.a.title},"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c"),s.a.createElement("p",null,"\u041b\u043e\u0433\u0438\u043d"),s.a.createElement("input",{type:"text",className:_.a.input,onChange:function(t){return e.props.setLogin(t.target.value)},onClick:v,value:this.props.login,maxLength:20,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d"}),s.a.createElement("p",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),s.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",type:"password",className:_.a.input,onChange:function(t){return e.props.setPassword(t.target.value)},value:this.props.password,onClick:function(){return e.props.removePassword()},maxLength:30}),s.a.createElement("div",{className:_.a.button,onClick:function(){return e.goToPage()}},"\u0412\u043e\u0439\u0442\u0438"),s.a.createElement("div",{className:_.a.button,onClick:function(){return e.registration()}},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")))}}]),t}(s.a.Component),V=Object(h.b)(function(e){return{login:e.login,password:e.password}},function(e){return Object(d.a)({setPage:g,setLogin:f,setPassword:E,removeLogin:v,removePassword:C},e)})(D),G=a(29),J=a.n(G),W=a(30),F=a.n(W),B=a(9),K=a.n(B),U=a(14),q=a.n(U),X=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t,a=this.props.data;return a.image&&(e=s.a.createElement("img",{src:"https://host-94-103-84-32.hosted-by-vdsina.ru"+a.image,className:q.a.message_image,alt:"images"})),a.text&&(t=s.a.createElement("div",{className:q.a.message_text},a.text)),s.a.createElement("div",{className:q.a.message},s.a.createElement("div",{className:q.a.message_user},a.user),t,s.a.createElement("div",{className:q.a.message_time},a.date),e)}}]),t}(s.a.Component),Y=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).scrollChat=function(e){if(0===e.target.scrollTop){H(JSON.stringify({Type:"chat",Command:"earlier"})),e.target.scrollTop=10}},a.deleteChat=function(){H(JSON.stringify({Type:"chat",Command:"purge"}))},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.messagesList,t=[];return t=0!==e.length?e.map(function(e,t){return s.a.createElement(X,{data:e,key:t})}):s.a.createElement("div",{className:K.a.loading},s.a.createElement("div",{className:K.a.line1}),s.a.createElement("div",{className:K.a.line2}),s.a.createElement("div",{className:K.a.line3})),s.a.createElement("div",{className:K.a.block},s.a.createElement("div",{className:K.a.chatName},this.props.activeChat,s.a.createElement("div",{className:K.a.deleteButton,onClick:this.deleteChat},"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0447\u0430\u0442")),s.a.createElement("div",{className:K.a.messagesList,onScroll:this.scrollChat},t))}},{key:"componentDidUpdate",value:function(){var e=document.querySelector("."+K.a.messagesList);e.scrollTop=e.scrollHeight}},{key:"componentDidMount",value:function(){var e=document.querySelector("."+K.a.messagesList);e.scrollTop=e.scrollHeight}}]),t}(s.a.Component),z=Object(h.b)(function(e){return{messagesList:e.messagesList,activeChat:e.activeChat}})(Y),Q=a(13),Z=a.n(Q),$=a(31),ee=a.n($),te=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={text:""},a.loadImage=function(e){var t=a.props.setImage,n=Object(k.a)(e.target.files),s=new ee.a;if(!n.length)return null;s.compress(n,{quality:.75,maxWidth:1920,maxHeight:1920}).then(function(e){t(e[0].prefix+e[0].data)})},a.pressEnter=function(e){"Enter"===e.key&&a.send()},a.changeTextInput=function(e){var t=e.target.value;t=t.replace("  "," "),a.setState({text:t})},a.send=function(){var e=a.state.text,t=a.props,n=t.image,s=t.setImage;if(""!==e&&" "!==e[e.length-1]||""!==n){var i={Type:"chat",Command:"message"};console.log(e,n),e&&(i.Text=e),n&&(i.Image=n),H(JSON.stringify(i)),s(""),a.setState({text:""})}},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.text,t=this.props.image;return s.a.createElement("div",{className:Z.a.block},s.a.createElement("div",{className:Z.a.imagesBlock},s.a.createElement("img",{className:Z.a.image,src:t,alt:""}),s.a.createElement("label",{htmlFor:"file",className:Z.a.inputFile},s.a.createElement("input",{type:"file",accept:"image/jpeg,image/png",style:{display:"none"},id:"file",onChange:this.loadImage}))),s.a.createElement("input",{className:Z.a.inputText,type:"text",onChange:this.changeTextInput,value:e,onKeyPress:this.pressEnter}),s.a.createElement("button",{className:Z.a.button,onClick:this.send},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"))}}]),t}(n.Component),ae=Object(h.b)(function(e){return{image:e.image}},{setImage:function(e){return{type:"SET_IMAGE",payload:e}}})(te),ne=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:F.a.block},s.a.createElement(z,null),s.a.createElement(ae,null))}}]),t}(s.a.Component),se=a(1),ie=a.n(se),ce=a(22),re=a.n(ce),oe=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).choiceChat=function(){var t={Type:"chat",Command:"choice",Chat:e.props.value.Chat};t=JSON.stringify(t),e.props.renderChatOutput(!1),e.props.removeMessagesList(),H(t),t={Type:"chat",Command:"connected"},t=JSON.stringify(t),H(t)},e.onPressEnter=function(t){"Enter"===t.key&&e.choiceSecretChat(e.props.value.Chat)},e.choiceSecretChat=function(t){var a={Type:"chat",Command:"choice",Chat:t,Password:e.state.chatPassword};a=JSON.stringify(a),H(a),e.props.renderChatOutput(!1),e.props.removeMessagesList(),e.setState({viewPasswordField:!1,chatPassword:""})},e.onChangePassword=function(t){e.setState({chatPassword:t})},e.state={viewPasswordField:!1,chatPassword:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.value;if(!1===a.Closed)e=s.a.createElement("div",{onClick:this.choiceChat,className:re.a.menu_chat_list_item},s.a.createElement("p",null,a.Chat));else if(!0===a.Closed){var n="";!0===this.state.viewPasswordField&&(n=s.a.createElement("input",{type:"text",value:this.props.chatPassword,onChange:function(e){return t.onChangePassword(e.target.value)},onKeyPress:function(e){return t.onPressEnter(e)},maxLength:30,autoFocus:!0})),e=s.a.createElement("div",{className:re.a.menu_chat_list_item,onClick:function(){return t.setState({viewPasswordField:!0})},onMouseLeave:function(){return t.setState({viewPasswordField:!1})}},s.a.createElement("p",null,a.Chat),n)}return s.a.createElement(s.a.Fragment,null,e)}}]),t}(s.a.Component),le=Object(h.b)(null,function(e){return Object(d.a)({removeMessagesList:O,renderChatOutput:w},e)})(oe),ue=a(23),me=a.n(ue),pe=a(24),_e=a.n(pe),he=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).updateClock=function(){setInterval(e.tick,5e3)},e.tick=function(){e.setState({time:_e()().format("lll")})},e.state={time:_e()().format("lll")},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.updateClock()}},{key:"render",value:function(){var e=this.state.time;return s.a.createElement("div",{className:me.a.clockBlock},s.a.createElement("div",{className:me.a.clock},e))}}]),t}(s.a.PureComponent),de=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={isView:!1,viewChatInput:!1},a.clickButton=function(){var e=a.state.isView;a.setState({isView:!e})},a.sendChat=function(e){if(""!==a.props.chatName&&"Enter"===e.key){var t={Type:"chat",Command:"create",Chat:a.props.chatName};""!==a.props.chatPassword&&(t.Password=a.props.chatPassword),t=JSON.stringify(t),I.send(t),a.props.removeChatName(),a.props.removeChatPassword()}},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.state.isView;console.log(t);var a=this.props.chatList;a=a.map(function(e,t){return s.a.createElement(le,{value:e,key:t})});var i="";return!1===this.state.viewChatInput?i=s.a.createElement("p",{className:ie.a.menu_chat,onClick:function(){return e.setState({viewChatInput:!e.state.viewChatInput})}},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0447\u0430\u0442"):!0===this.state.viewChatInput&&(i=s.a.createElement(n.Fragment,null,s.a.createElement("p",{className:ie.a.menu_chat,onClick:function(){return e.setState({viewChatInput:!e.state.viewChatInput})}},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),s.a.createElement("p",{className:ie.a.menu_chat},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0447\u0430\u0442\u0430"),s.a.createElement("input",{type:"text",className:ie.a.input,onChange:function(t){return e.props.addChatName(t.target.value)},onKeyPress:function(t){return e.sendChat(t)},value:this.props.chatName,onClick:function(){return e.props.removeChatName()},maxLength:12}),s.a.createElement("p",{className:ie.a.menu_chat},"\u041f\u0430\u0440\u043e\u043b\u044c (\u043d\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e)"),s.a.createElement("input",{type:"text",className:ie.a.input,onChange:function(t){return e.props.addChatPassword(t.target.value)},onKeyPress:function(t){return e.sendChat(t)},value:this.props.chatPassword,onClick:function(){return e.props.removeChatPassword()},maxLength:30}))),s.a.createElement(n.Fragment,null,s.a.createElement("div",{className:t?ie.a.blockView:ie.a.blockHide},s.a.createElement("button",{className:ie.a.button,onClick:this.clickButton},s.a.createElement("div",{className:ie.a.burger},s.a.createElement("div",{className:t?ie.a.line1Active:ie.a.line1}),s.a.createElement("div",{className:t?ie.a.line2Active:ie.a.line2}),s.a.createElement("div",{className:t?ie.a.line3Active:ie.a.line3}))),s.a.createElement("div",{className:ie.a.menu},s.a.createElement("div",{className:ie.a.menu_image}),s.a.createElement("p",{className:ie.a.menu_login},this.props.login),i,s.a.createElement("p",{className:ie.a.menu_chat},"\u0421\u043f\u0438\u0441\u043e\u043a \u0447\u0430\u0442\u043e\u0432:"),s.a.createElement("div",{className:ie.a.menu_chat_list},a),s.a.createElement(he,null))))}}]),t}(n.PureComponent),ge=Object(h.b)(function(e){return{login:e.login,chatList:e.chatList,chatName:e.chatName,chatPassword:e.chatPassword}},function(e){return Object(d.a)({addChatName:y,removeChatName:N,activeChat:j,removeMessagesList:O,removeChatPassword:S,addChatPassword:M},e)})(de),fe=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:J.a.layout},s.a.createElement(ge,null),s.a.createElement(ne,null))}}]),t}(s.a.Component),Ee=a(15),ve=a.n(Ee),Ce=function(){return s.a.createElement("div",{className:ve.a.block},s.a.createElement("p",{className:ve.a.text},"Connecting to server"),s.a.createElement("div",{className:ve.a.line1}),s.a.createElement("div",{className:ve.a.line2}),s.a.createElement("div",{className:ve.a.line3}))},be=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.page;return s.a.createElement("div",{className:"App"},"loading"===e&&s.a.createElement(Ce,null),"authentification"===e&&s.a.createElement(V,null),"main"===e&&s.a.createElement(fe,null))}}]),t}(n.Component),Oe=Object(h.b)(function(e){return{page:e.page}})(be);c.a.render(s.a.createElement(h.a,{store:P},s.a.createElement(Oe,null)),document.getElementById("root"))}],[[32,1,2]]]);
//# sourceMappingURL=main.0ee42406.chunk.js.map