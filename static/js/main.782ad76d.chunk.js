(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,function(e,t,a){e.exports={menu:"MainMenu_menu__38NUy",menu_image:"MainMenu_menu_image__3kold",menu_login:"MainMenu_menu_login__J-DOZ",menu_chat:"MainMenu_menu_chat__RXXU8",menu_chat_list:"MainMenu_menu_chat_list__1Smpe",input:"MainMenu_input__213Gt"}},,,function(e,t,a){e.exports={block:"Chatbox_block__OWqB5",input:"Chatbox_input__1nWLP",button:"Chatbox_button__1awb1",chat:"Chatbox_chat__-T56v",button_file:"Chatbox_button_file__1rqcP",imagesBlock:"Chatbox_imagesBlock__wfIuV",pictures:"Chatbox_pictures__2N1yo",image:"Chatbox_image__3E6kr"}},,function(e,t,a){e.exports={page:"AuthentificationPage_page__2HM45",layout:"AuthentificationPage_layout__1btWJ",button:"AuthentificationPage_button__1nnUE",input:"AuthentificationPage_input__2s8ii",title:"AuthentificationPage_title__3nREf"}},,,function(e,t,a){e.exports={output:"ChatOutput_output__3SkVW",nameChat:"ChatOutput_nameChat__1_IsS",messagesList:"ChatOutput_messagesList__jQdkp",deleteButton:"ChatOutput_deleteButton__3xEyy"}},function(e,t,a){e.exports={message:"Message_message__M956o",message_user:"Message_message_user__3ftx_",message_text:"Message_message_text__2xRKS",message_time:"Message_message_time__3wmGK",message_image:"Message_message_image__Iby-h"}},function(e,t,a){e.exports={block:"LoadingPage_block__1IOaF",text:"LoadingPage_text__3JhiI",line1:"LoadingPage_line1__2Y0t1",spin:"LoadingPage_spin__2HKox",line2:"LoadingPage_line2__11m1-",line3:"LoadingPage_line3__2g_cJ"}},,,,,,,function(e,t,a){e.exports={enter:"transition_enter__2o_yK",enterActive:"transition_enterActive__WgKbf",exit:"transition_exit__3Q8I9",exitActive:"transition_exitActive__1bHAW"}},function(e,t,a){e.exports={menu_chat_list_item:"ChatItem_menu_chat_list_item__1gxCS"}},function(e,t,a){e.exports={clockBLock:"Clock_clockBLock__2HsNj",clock:"Clock_clock__1ljTg"}},,,,function(e,t,a){e.exports=a.p+"static/media/new_message.8b29b843.mp3"},,,function(e,t,a){e.exports={layout:"MainPage_layout__1NnJr",chatbox:"MainPage_chatbox__2SPmk",output:"MainPage_output__1Lfo1",input:"MainPage_input__2q5-T",button:"MainPage_button__3Je2V"}},,,function(e,t,a){e.exports=a(54)},,,,,function(e,t,a){},,,,,function(e,t,a){},,,,function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(18),c=a.n(r),o=(a(45),a(2)),i=a(3),u=a(5),l=a(4),m=a(6),p=a(1),h=a(16),g=a.n(h),_=a(57),d=a(56),f=a(7),E=a(10),C=a(28),v=a.n(C),O=(a(50),function(e){return{type:"SET_PAGE",page:e}}),b=function(e){return{type:"SET_LOGIN",login:e}},y=function(e){return{type:"SET_PASSWORD",password:e}},S=function(){return{type:"REMOVE_LOGIN"}},N=function(){return{type:"REMOVE_PASSWORD"}},j=function(e){return{type:"SET_MESSAGE",message:e}},w=function(e){return{type:"SET_MESSAGES_LIST",messagesList:e}},P=function(){return{type:"REMOVE_MESSAGES_LIST"}},M=function(){return{type:"REMOVE_MESSAGE"}},A=function(e){return{type:"ADD_CHAT_NAME",chatName:e}},L=function(){return{type:"REMOVE_CHAT_NAME"}},T=function(e){return{type:"ADD_CHAT_PASSWORD",chatPassword:e}},k=function(){return{type:"REMOVE_CHAT_PASSWORD"}},x=function(e){return{type:"ACTIVE_CHAT",chat:e}},I=function(e){return{type:"RENDER_CHAT_OUTPUT",payload:e}},R=function(e){return{type:"ADD_IMAGE",image:e}},D=function(){return{type:"CLEAR_IMAGES"}},G=a(23),H={page:"loading",login:"login",password:"password",authentification:!1,connect:!1,message:"",messagesList:[],chatList:[],chatName:"",chatPassword:"",activeChat:"",renderChatOutput:!0,images:""};var J=Object(E.b)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PAGE":return Object(p.a)({},e,{page:t.page});case"SET_LOGIN":return Object(p.a)({},e,{login:t.login});case"SET_PASSWORD":return Object(p.a)({},e,{password:t.password});case"REMOVE_LOGIN":return Object(p.a)({},e,{login:""});case"REMOVE_PASSWORD":return Object(p.a)({},e,{password:""});case"AUTHENTIFICATION":return Object(p.a)({},e,{authentification:t.authentification});case"CONNECT":return Object(p.a)({},e,{connect:t.connect});case"SET_MESSAGE":return Object(p.a)({},e,{message:t.message});case"SET_MESSAGES_LIST":return Object(p.a)({},e,{messagesList:e.messagesList.concat(t.messagesList)});case"REMOVE_MESSAGE":return Object(p.a)({},e,{message:""});case"SET_CHAT_LIST":return Object(p.a)({},e,{chatList:t.chatList});case"ADD_CHAT_NAME":return Object(p.a)({},e,{chatName:t.chatName});case"REMOVE_CHAT_NAME":return Object(p.a)({},e,{chatName:""});case"ADD_CHAT_PASSWORD":return Object(p.a)({},e,{chatPassword:t.chatPassword});case"REMOVE_CHAT_PASSWORD":return Object(p.a)({},e,{chatPassword:""});case"ACTIVE_CHAT":return Object(p.a)({},e,{activeChat:t.chat});case"REMOVE_MESSAGES_LIST":return Object(p.a)({},e,{messagesList:[]});case"RENDER_CHAT_OUTPUT":return Object(p.a)({},e,{renderChatOutput:t.payload});case"EARLIER_MESSAGES":return Object(p.a)({},e,{messagesList:[].concat(Object(G.a)(t.payload),Object(G.a)(e.messagesList))});case"ADD_IMAGE":return Object(p.a)({},e,{images:t.image});case"CLEAR_IMAGES":return Object(p.a)({},e,{images:""});default:return e}},H),V=a(34),W=a.n(V),F=new WebSocket("wss://host-94-103-84-32.hosted-by-vdsina.ru:443/");F.onopen=function(){J.dispatch(O("authentification")),J.dispatch({type:"CONNECT",connect:!0})},F.onclose=function(){console.log("disconnect"),J.dispatch(O("loading"))},F.onmessage=function(e){var t=JSON.parse(e.data);if(console.log(t),null!==t)switch(t.Type){case"login":if("success"===t.Status){J.dispatch(O("main"));var a={Type:"chat",Command:"choice",Chat:"general"};a=JSON.stringify(a),B(a),a={Type:"chat",Command:"connected"},a=JSON.stringify(a),B(a),J.dispatch(I(!1))}else"error"===t.Status&&console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438");break;case"registration":console.log("\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f");break;case"chat":if("list"===t.Command&&J.dispatch({type:"SET_CHAT_LIST",chatList:t.Chats}),"choice"===t.Command&&(J.dispatch(x(t.Chat)),J.dispatch(w(t.Messages)),J.dispatch(I(!0))),"message"===t.Command){if(t.Message.user!==J.getState().login){var n=new Audio;n.src=W.a,n.play()}J.dispatch(w(t.Message))}"earlier"===t.Command&&0!==t.Messages.length&&J.dispatch(function(e){return{type:"EARLIER_MESSAGES",payload:e}}(t.Messages));break;default:console.log(t)}},F.onerror=function(e){console.log("error: ",e)};var B=function(e){F.send(e)},K=B,U=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(s)))).goToPage=function(){if(""!==a.props.login&&""!==a.props.password){var e={Type:"login",Login:a.props.login,Password:a.props.password};e=JSON.stringify(e),K(e)}},a.registration=function(){if(""!==a.props.login&&""!==a.props.password){var e={Type:"registration",Login:a.props.login,Password:a.props.password};e=JSON.stringify(e),K(e)}},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return console.log(v.a),s.a.createElement(_.a,null,s.a.createElement(d.a,{in:!0,classNames:Object(p.a)({},v.a),timeout:3e3},s.a.createElement("div",{className:g.a.page},s.a.createElement("div",{className:g.a.layout},s.a.createElement("p",{className:g.a.title},"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c"),s.a.createElement("p",null,"\u041b\u043e\u0433\u0438\u043d"),s.a.createElement("input",{type:"text",className:g.a.input,onChange:function(t){return e.props.setLogin(t.target.value)},onClick:S,value:this.props.login,maxLength:20,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d"}),s.a.createElement("p",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),s.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",type:"password",className:g.a.input,onChange:function(t){return e.props.setPassword(t.target.value)},value:this.props.password,onClick:function(){return e.props.removePassword()},maxLength:30}),s.a.createElement("div",{className:g.a.button,onClick:function(){return e.goToPage()}},"\u0412\u043e\u0439\u0442\u0438"),s.a.createElement("div",{className:g.a.button,onClick:function(){return e.registration()}},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")))))}}]),t}(s.a.Component),q=Object(f.b)(function(e){return{login:e.login,password:e.password}},function(e){return Object(E.a)({setPage:O,setLogin:b,setPassword:y,removeLogin:S,removePassword:N},e)})(U),Q=a(37),X=a.n(Q),z=a(14),Y=a.n(z),Z=a(19),$=a.n(Z),ee=a(20),te=a.n(ee),ae=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t,a=this.props.data;return a.image&&(e=s.a.createElement("img",{src:"https://host-94-103-84-32.hosted-by-vdsina.ru"+a.image,className:te.a.message_image,alt:"images"})),a.text&&(t=s.a.createElement("div",{className:te.a.message_text},a.text)),s.a.createElement("div",{className:te.a.message},s.a.createElement("div",{className:te.a.message_user},a.user),t,s.a.createElement("div",{className:te.a.message_time},a.date),e)}}]),t}(s.a.Component),ne=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(s)))).scrollChat=function(e){if(0===e.target.scrollTop){F.send(JSON.stringify({Type:"chat",Command:"earlier"})),e.target.scrollTop=10}},a.deleteChat=function(){F.send(JSON.stringify({Type:"chat",Command:"purge"}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.messagesList,t=[];return 0!==e.length&&(t=e.map(function(e,t){return s.a.createElement(ae,{data:e,key:t})})),s.a.createElement("div",{className:$.a.output},s.a.createElement("div",{className:$.a.nameChat},this.props.activeChat,s.a.createElement("div",{className:$.a.deleteButton,onClick:this.deleteChat},"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0447\u0430\u0442")),s.a.createElement("div",{className:$.a.messagesList,onScroll:this.scrollChat},t))}},{key:"componentDidMount",value:function(){var e=document.querySelector("."+$.a.messagesList);e.scrollTop=e.scrollHeight}}]),t}(s.a.Component),se=Object(f.b)(function(e){return{messagesList:e.messagesList,activeChat:e.activeChat}},null)(ne),re=a(38),ce=a.n(re),oe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(s)))).sendMessage=function(){if(""!==a.props.activeChat&&(""!==a.props.message||""!==a.props.images)){var e={Type:"chat",Command:"message"};""!==a.props.message&&(e.Text=a.props.message),""!==a.props.images&&(e.Image=a.props.images),e=JSON.stringify(e),console.log(e),K(e),a.props.removeMessage(),a.props.clearImages()}},a.pressEnter=function(e){"Enter"===e.key&&a.sendMessage()},a.onChangeMessage=function(e){"\n"!==e&&a.props.setMessage(e)},a.loadImage=function(e){var t=Object(G.a)(e.target.files);console.log(t[0].size),(new ce.a).compress(t,{quality:.75,maxWidth:1920,maxHeight:1920}).then(function(e){console.log(e[0]),a.props.addImage(e[0].prefix+e[0].data)})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=null,a=s.a.createElement("div",{className:Y.a.image,style:{backgroundImage:"url(".concat(this.props.images,")")}});return this.props.renderChatOutput&&(t=s.a.createElement(se,null)),s.a.createElement("div",{className:Y.a.block},s.a.createElement("div",{className:Y.a.chat},t),s.a.createElement("div",{className:Y.a.input},s.a.createElement("div",{className:Y.a.imagesBlock},s.a.createElement("label",{htmlFor:"file",className:Y.a.button_file},s.a.createElement("input",{type:"file",accept:"image/jpeg,image/png",style:{display:"none"},id:"file",onChange:function(t){return e.loadImage(t)}})),s.a.createElement("div",{className:Y.a.pictures},a)),s.a.createElement("textarea",{onChange:function(t){return e.onChangeMessage(t.target.value)},value:this.props.message,onKeyPress:function(t){return e.pressEnter(t)}}),s.a.createElement("div",{className:Y.a.button,onClick:function(){return e.sendMessage()}},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")))}}]),t}(s.a.Component),ie=Object(f.b)(function(e){return{message:e.message,login:e.login,activeChat:e.activeChat,renderChatOutput:e.renderChatOutput,images:e.images}},function(e){return Object(E.a)({setMessage:j,removeMessage:M,clearImages:D,addImage:R},e)})(oe),ue=a(11),le=a.n(ue),me=a(29),pe=a.n(me),he=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).choiceChat=function(){var t={Type:"chat",Command:"choice",Chat:e.props.value.Chat};t=JSON.stringify(t),e.props.renderChatOutput(!1),e.props.removeMessagesList(),K(t),t={Type:"chat",Command:"connected"},t=JSON.stringify(t),K(t)},e.onPressEnter=function(t){"Enter"===t.key&&e.choiceSecretChat(e.props.value.Chat)},e.choiceSecretChat=function(t){var a={Type:"chat",Command:"choice",Chat:t,Password:e.state.chatPassword};a=JSON.stringify(a),K(a),e.props.renderChatOutput(!1),e.props.removeMessagesList(),e.setState({viewPasswordField:!1,chatPassword:""})},e.onChangePassword=function(t){e.setState({chatPassword:t})},e.state={viewPasswordField:!1,chatPassword:""},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.value;if(!1===a.Closed)e=s.a.createElement("div",{onClick:this.choiceChat,className:pe.a.menu_chat_list_item},s.a.createElement("p",null,a.Chat));else if(!0===a.Closed){var n="";!0===this.state.viewPasswordField&&(n=s.a.createElement("input",{type:"text",value:this.props.chatPassword,onChange:function(e){return t.onChangePassword(e.target.value)},onKeyPress:function(e){return t.onPressEnter(e)},maxLength:30,autoFocus:!0})),e=s.a.createElement("div",{className:pe.a.menu_chat_list_item,onClick:function(){return t.setState({viewPasswordField:!0})},onMouseLeave:function(){return t.setState({viewPasswordField:!1})}},s.a.createElement("p",null,a.Chat),n)}return s.a.createElement(s.a.Fragment,null,e)}}]),t}(s.a.Component),ge=Object(f.b)(null,function(e){return Object(E.a)({removeMessagesList:P,renderChatOutput:I},e)})(he),_e=a(30),de=a.n(_e),fe=a(24),Ee=a.n(fe),Ce=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).updateClock=function(){setInterval(e.tick,5e3)},e.tick=function(){e.setState({time:Ee()().locale("ru").format("LLL")})},e.state={time:Ee()().locale("ru").format("LLL")},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.updateClock()}},{key:"render",value:function(){console.log(Ee()().format("LT"));var e=this.state.time;return s.a.createElement("div",{className:de.a.clockBlock},s.a.createElement("div",{className:de.a.clock},e))}}]),t}(s.a.PureComponent),ve=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).sendChat=function(t){if(""!==e.props.chatName&&"Enter"===t.key){var a={Type:"chat",Command:"create",Chat:e.props.chatName};""!==e.props.chatPassword&&(a.Password=e.props.chatPassword),a=JSON.stringify(a),F.send(a),e.props.removeChatName(),e.props.removeChatPassword()}},e.state={viewChatInput:!1},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.chatList;t=t.map(function(e,t){return s.a.createElement(ge,{value:e,key:t})});var a="";return!1===this.state.viewChatInput?a=s.a.createElement("p",{className:le.a.menu_chat,onClick:function(){return e.setState({viewChatInput:!e.state.viewChatInput})}},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0447\u0430\u0442"):!0===this.state.viewChatInput&&(a=s.a.createElement(s.a.Fragment,null,s.a.createElement("p",{className:le.a.menu_chat,onClick:function(){return e.setState({viewChatInput:!e.state.viewChatInput})}},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),s.a.createElement("p",{className:le.a.menu_chat},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0447\u0430\u0442\u0430"),s.a.createElement("input",{type:"text",className:le.a.input,onChange:function(t){return e.props.addChatName(t.target.value)},onKeyPress:function(t){return e.sendChat(t)},value:this.props.chatName,onClick:function(){return e.props.removeChatName()},maxLength:12}),s.a.createElement("p",{className:le.a.menu_chat},"\u041f\u0430\u0440\u043e\u043b\u044c (\u043d\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e)"),s.a.createElement("input",{type:"text",className:le.a.input,onChange:function(t){return e.props.addChatPassword(t.target.value)},onKeyPress:function(t){return e.sendChat(t)},value:this.props.chatPassword,onClick:function(){return e.props.removeChatPassword()},maxLength:30}))),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:le.a.menu},s.a.createElement("div",{className:le.a.menu_image}),s.a.createElement("p",{className:le.a.menu_login},this.props.login),a,s.a.createElement("p",{className:le.a.menu_chat},"\u0421\u043f\u0438\u0441\u043e\u043a \u0447\u0430\u0442\u043e\u0432:"),s.a.createElement("div",{className:le.a.menu_chat_list},t),s.a.createElement(Ce,null)))}}]),t}(s.a.Component),Oe=Object(f.b)(function(e){return{login:e.login,chatList:e.chatList,chatName:e.chatName,chatPassword:e.chatPassword}},function(e){return Object(E.a)({addChatName:A,removeChatName:L,activeChat:x,removeMessagesList:P,removeChatPassword:k,addChatPassword:T},e)})(ve),be=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:X.a.layout},s.a.createElement(Oe,null),s.a.createElement(ie,null))}}]),t}(s.a.Component),ye=a(21),Se=a.n(ye),Ne=function(){return s.a.createElement("div",{className:Se.a.block},s.a.createElement("p",{className:Se.a.text},"Connecting to server"),s.a.createElement("div",{className:Se.a.line1}),s.a.createElement("div",{className:Se.a.line2}),s.a.createElement("div",{className:Se.a.line3}))},je=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.page;return s.a.createElement("div",{className:"App"},"loading"===e&&s.a.createElement(Ne,null),"authentification"===e&&s.a.createElement(q,null),"main"===e&&s.a.createElement(be,null))}}]),t}(n.Component),we=Object(f.b)(function(e){return{page:e.page}})(je);c.a.render(s.a.createElement(f.a,{store:J},s.a.createElement(we,null)),document.getElementById("root"))}],[[40,1,2]]]);
//# sourceMappingURL=main.782ad76d.chunk.js.map